# Grasp Object Task
# Robot must grasp and lift target objects using the gripper

run:
  algorithm:
    load_model: False
    model_path: ""  
    type: "PPO"
    config: {}
  train:
    num_envs: 4
    logging: 0
    timesteps: 1000000  # More timesteps for harder task
    save_freq: 10000
    save_folder: "./models/weights"  
    save_name: "grasp_object"
  eval:
    max_episodes: -1
    logging: 1
    display_delay: 0.01
    show_world_aux: True
    show_goal_aux: True
    show_sensor_aux: False

env:
  max_steps_per_episode: 512  # Longer episodes for grasping task
  stat_buffer_size: 25  
  normalize_observations: False
  normalize_rewards: False
  use_physics_sim: True
  gravity: [0, 0, -9.8]
  sim_step: 0.01
  sim_steps_per_env_step: 1
  
  robots:
    - type: "UR5_Gripper"  
      config:
        name: "ur5_robot"
        base_position: [0, 0, 0.630]
        base_orientation: [0, 0, 0]
        resting_angles: [0, -90, -90, -90, 90, 0]
        control_mode: 0  # IK control
        ik_xyz_delta: 0.05
        ik_rpy_delta: 0.05
        self_collision: False
        gripper_control: True  # Enable gripper control
        
      sensors:
        - type: "LidarSensorUR5"
          config:
            update_steps: 1
            add_to_observation_space: True
            add_to_logging: True
            indicator_buckets: 6
            ray_start: 0
            ray_end: 0.4
            ray_setup:
              ee_forward: [1, 1]
              wrist3_circle: [8, 5]
              wrist2_circle: [8, 5]
              wrist1_circle: [8, 5]
              upper_arm: [8, 5]
            indicator: True
            
      goal:
        type: "GraspObject"
        config:
          add_to_logging: True
          continue_after_success: False  # End episode on success
          reward_success: 50.0           # Large reward for grasp+lift
          reward_lift: 10.0              # Bonus for lifting
          reward_grasp: 5.0              # Bonus for grasping
          reward_contact: 2.0            # Bonus for being near target
          reward_collision: -5.0         # Penalty for collisions
          reward_distance_mult: -0.01    # Distance shaping
          contact_threshold: 0.08        # 8cm = close enough to grasp
          lift_threshold: 0.15           # Must lift 15cm for success
          dist_threshold_start: 0.10     # Start with 10cm threshold
          dist_threshold_end: 0.03       # Final threshold 3cm
          dist_threshold_increment_start: 0.005
          dist_threshold_increment_end: 0.001
          dist_threshold_change: 0.7     # Reduce threshold at 70% success

  world:
    type: "ManipulateObjects"
    config:
      workspace_boundaries: [-0.8, 0.8, -0.6, 1.6, 0.2, 1.6]
      num_boxes: 2         # Fewer objects for simpler grasping
      num_spheres: 1
      add_table: True
      table_dim: [0.625, 0.5, 1.0]  # height, width, length
